_format_version: "3.0"
_info:
  defaults: {}
  select_tags:
    - test

upstreams:
  - name: payments-auth-test-upstream
    algorithm: round-robin
    targets:
      - id: cf6b2690-08db-42f0-bd8b-95652e1698ae
        target: api.pagar.me:443
        weight: 0
      - id: 53b74a58-ae3d-4ffa-8299-dd8113477f6b
        target: httpbin.org:443
        weight: 100

services:
  - name: test
    host: test.com
    enabled: true
    port: 443
    protocol: https
    tls_verify: false
    plugins:
      - name: jwt-auth
        enabled: true
        protocols:
          - https
        config:
          header-keys:
            - Authorization
          bypass-if-headers:
            - provider-key
            - provider-id
          iss-urls: https://...
          jwk-urls: https://...
          jwt-config:
            permitted-algs: null
            permitted-token-types: null
            required-claims: null
          policy-key: null
    routes:
      - name: test-route
        hosts:
          - test.com
        protocols:
          - http
        methods:
          - GET
        paths:
          - /auth/teste
        strip_path: false
        plugins:
          - name: jwt-auth
            enabled: true
            protocols:
              - http
            config:
              header-keys:
                - Authorization
              bypass-if-headers:
                - provider-key
                - provider-id
              iss-urls: https://a
              jwk-urls: https://
              jwt-config:
                permitted-algs: null
                permitted-token-types: null
                required-claims: null
              policy-key: null
    tags:
      - test
